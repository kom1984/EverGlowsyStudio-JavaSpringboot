<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head
        th:replace="~{fragments/general.html :: head}">
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }
        .available {
            background-color: lightgreen;
        }
    </style>
</head>
<nav
        th:replace="~{fragments/general.html :: navbar}">
</nav>

<div class="container my-5">
    <div class="row my-5 " th:each="service:${service1}">
        <div class="col-sm-10 mx-auto my-5" >
            <h2>1.Choix de la prestation </h2>
            <div class="card">
                 <div class="card-body  d-flex justify-content-between" >
                    <h5 class="card-title" th:text="${service.name_service}"></h5>
                    <div class="d-flex ">

                        <p class="card-text" th:text="${service.price}"> </p>
                        <span th:text="${service.name_service}"></span>


                        <div><p class="card-text" th:text="${service.time_service+'&nbsp;'+'&nbsp;'+'&nbsp;'}"> </p>
                            <ul id="selectedItems"></ul>
                        </div>

                        <div><button class="btn btn-secondary" >Ajouter prestations</button></div>
                    </div>

                </div>
            </div>
        </div>


        </div>
    <div id="div2" style="display:none;">
        <div class="row">
            <div class="col-md-12">
                <div class="section-header text-center pb-5">
                    <h2>Prise Un Rendez-Vous</h2>

                </div>
            </div>
            <div class="row" id="services" th:each="category:${categories}">
                <div class="col-sm-10 mx-auto" >
                    <div class="card">
                        <div class="card-header text-uppercase" th:text="${category.name_category}">

                        </div>
                        <div class="card-body  d-flex justify-content-between" th:each="service:${services}" th:if="(${category.id_category} == ${service.category.id_category})">
                            <h5 class="card-title" th:text="${service.name_service}"></h5>
                            <div class="d-flex ">

                                <p class="card-text" th:text="${service.price}"> </p>
                                <span  th:utext="${'&#8364;'+'&nbsp;'+'&nbsp;'+'&nbsp;'}"></span>


                                <div><p class="card-text" th:text="${service.time_service+'&nbsp;'+'&nbsp;'+'&nbsp;'}"> </p>

                                </div>

                                <div>
                                    <button onclick="addSelectedItems()" class="btn btn-secondary"  >Choisir</button>

                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row mx-5 my-5">
        <div class="col-lg-6 col-sm-12 col-md-6 justify-content-center ">
            <div class="card">
            <h2>2.Choix de la date:</h2>
            <input type="text" id="datepicker" />
                </div>
        </div>

        <div class="col-lg-6 col-sm-12 col-md-6 justify-content-center ">
            <div class="card">
            <h2>3.Choix de l'heure:</h2>
            <select id="timeSlotSelect">
                <!-- Options will be generated dynamically using JavaScript -->
            </select>
                </div>
        </div>
    </div>



</div>


<footer
        th:replace="~{fragments/general.html :: footer}">
</footer>
<!-- footer ends -->
<script>
    $(function () {
      // Function to check if a given date is a working day (Monday to Friday)
      function isWorkingDay(date) {
        var day = date.getDay();
        return day !== 0 && day !== 6; // Sunday (0) and Saturday (6) are not working days
      }

      // Initialize datepicker
      $("#datepicker").datepicker({
        beforeShowDay: function (date) {
          var isWeekday = isWorkingDay(date);
          var isNotPast = !isPastDate(date);
          return [isWeekday && isNotPast, ""];
        },
      });

      // Function to check if a given date is in the past
      function isPastDate(date) {
        var today = new Date();
        today.setHours(0, 0, 0, 0);
        return date < today;
      }
    });

      // Function to generate time slots
      function generateTimeSlots(startHour, endHour, intervalMinutes) {
        var select = document.getElementById("timeSlotSelect");
        select.innerHTML = ""; // Clear existing options

        // Loop to generate time slots
        for (var hour = startHour; hour <= endHour; hour++) {
          for (var minute = 0; minute < 60; minute += intervalMinutes) {
            var time =
              hour.toString().padStart(2, "0") +
              ":" +
              minute.toString().padStart(2, "0");
            var option = new Option(time, time);
            select.appendChild(option);
          }
        }
      }

      // Generate time slots from 10:00 to 19:00 with 15-minute intervals
      generateTimeSlots(10, 19, 15);


      $(document).ready(function(){
        $("button").click(function(){
          $("#div2").toggle();
        });
      });

function addSelectedItems() {
      var selectedItemsList = document.getElementById("selectedItems");
      var selectElement = document.getElementById("services");
      for (var i = 0; i < selectElement.options.length; i++) {
        if (selectElement.options[i].selected) {
          var listItem = document.createElement("li");
          // Use Thymeleaf expression to get the selected item text
          listItem.textContent = selectElement.options[i].text;
          selectedItemsList.appendChild(listItem);
        }
      }
    }
</script>

 </body>
</html>
